<mxfile host="app.diagrams.net" modified="2021-06-25T03:50:15.865Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36" etag="ZhUiYH85HV4bl8yTeHaJ" version="14.8.0" type="github">
  <diagram id="NBq3CgPERG1pBXBx40WU" name="Page-1">
    <mxGraphModel dx="946" dy="479" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-69" value="" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;labelBackgroundColor=none;sketch=0;fontSize=11;fontColor=#000000;strokeWidth=1;fillColor=none;align=right;verticalAlign=bottom;" vertex="1" parent="1">
          <mxGeometry x="200" y="160" width="880" height="440" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-57" value="&lt;b&gt;&lt;font color=&quot;#ea6b66&quot;&gt;根据设备特征、管理PIN及用户PIN计算&lt;br&gt;不落地保存&lt;/font&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;labelBackgroundColor=none;sketch=0;fontColor=#000000;strokeWidth=1;align=right;verticalAlign=bottom;dashed=1;fillColor=none;strokeColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="600" y="200" width="240" height="360" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1" source="Ex2G36TkrBTLP0KI2J1V-1" target="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="610" y="372" />
              <mxPoint x="610" y="372" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-35" value="SM4" style="edgeLabel;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="Ex2G36TkrBTLP0KI2J1V-34">
          <mxGeometry x="-0.1828" y="-1" relative="1" as="geometry">
            <mxPoint x="-24" y="-8" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#d5e8d4;strokeColor=#82b366;entryX=1.004;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="640" y="400" as="sourcePoint" />
            <mxPoint x="569.9200000000001" y="400" as="targetPoint" />
            <Array as="points">
              <mxPoint x="620" y="400" />
              <mxPoint x="620" y="400" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-37" value="SM4" style="edgeLabel;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;labelBorderColor=none;" vertex="1" connectable="0" parent="Ex2G36TkrBTLP0KI2J1V-36">
          <mxGeometry x="-0.1935" y="4" relative="1" as="geometry">
            <mxPoint x="-24" y="-13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-1" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;DFK(设备指纹密钥)&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;br&gt;&lt;font color=&quot;#f19c99&quot; style=&quot;font-size: 11px&quot;&gt;基于设备唯一标识加盐处理取后16字节&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="640" y="360" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-33" value="SM4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;fillColor=#fff2cc;strokeColor=#d6b656;entryX=1;entryY=0.736;entryDx=0;entryDy=0;entryPerimeter=0;labelBackgroundColor=none;" edge="1" parent="1" source="Ex2G36TkrBTLP0KI2J1V-2" target="Ex2G36TkrBTLP0KI2J1V-59">
          <mxGeometry x="0.7465" y="-8" relative="1" as="geometry">
            <mxPoint x="530" y="346" as="targetPoint" />
            <Array as="points">
              <mxPoint x="675" y="346" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-2" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;APK(管理私钥保护密钥)&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;span&gt;&lt;font style=&quot;font-size: 11px&quot; color=&quot;#f19c99&quot;&gt;DFK加密管理PIN得到的密文&lt;/font&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="640" y="250" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;fontColor=#FF0000;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#f0a30a;strokeColor=#BD7000;" edge="1" parent="1" source="Ex2G36TkrBTLP0KI2J1V-3" target="Ex2G36TkrBTLP0KI2J1V-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="470" />
              <mxPoint x="850" y="346" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-61" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;fontColor=#FF0000;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#f0a30a;strokeColor=#BD7000;" edge="1" parent="1" source="Ex2G36TkrBTLP0KI2J1V-3" target="Ex2G36TkrBTLP0KI2J1V-39">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="470" />
              <mxPoint x="850" y="424" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-63" value="SM4" style="edgeLabel;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;labelBackgroundColor=none;" vertex="1" connectable="0" parent="Ex2G36TkrBTLP0KI2J1V-61">
          <mxGeometry x="0.7206" y="2" relative="1" as="geometry">
            <mxPoint x="1" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-3" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;UPK(用户私钥保护密钥)&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;span&gt;&lt;font style=&quot;font-size: 11px&quot; color=&quot;#f19c99&quot;&gt;DFK加密用户PIN得到的密文&lt;/font&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="640" y="440" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-13" value="应用表" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" vertex="1" parent="1">
          <mxGeometry x="339" y="281" width="230" height="182" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-14" value="adk_pub--管理公钥" style="text;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="26" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#1ba1e2;strokeColor=#006EAF;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="Ex2G36TkrBTLP0KI2J1V-13" source="Ex2G36TkrBTLP0KI2J1V-14" target="Ex2G36TkrBTLP0KI2J1V-43">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="26" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="-59" y="39" />
              <mxPoint x="-59" y="169" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-53" value="公钥加密" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#000000;" vertex="1" connectable="0" parent="Ex2G36TkrBTLP0KI2J1V-44">
          <mxGeometry x="0.7652" relative="1" as="geometry">
            <mxPoint x="-3" y="-13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-15" value="adk_pk8--管理私钥" style="text;fillColor=#fff2cc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="52" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-31" value="adm_msg--SM3(管理PIN)和错误尝试次数" style="text;fillColor=#d5e8d4;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="78" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-16" value="user_msg--SM3(用户PIN)和错误尝试次数" style="text;fillColor=#d5e8d4;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="104" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-32" value="name--应用名称" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="130" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-43" value="user_pin--用户PIN" style="text;fillColor=#1ba1e2;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontColor=#ffffff;fontSize=11;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-13">
          <mxGeometry y="156" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-17" value="容器表" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" vertex="1" parent="1">
          <mxGeometry x="880" y="281" width="140" height="234" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-18" value="sig_cer--签名证书" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="26" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-19" value="sig_pk8--签名证书私钥" style="text;fillColor=#f0a30a;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontColor=#000000;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="52" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-20" value="sig_pub--签名证书公钥" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="78" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-38" value="enc_cer--加密证书" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="104" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-39" value="enc_pk8--加密证书私钥" style="text;fillColor=#f0a30a;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontColor=#000000;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="130" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-40" value="enc_pub--加密证书公钥" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="156" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-41" value="name--容器名" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="182" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-42" value="app_id--所在应用" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="Ex2G36TkrBTLP0KI2J1V-17">
          <mxGeometry y="208" width="140" height="26" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-59" value="&lt;div style=&quot;color: rgb(0 , 0 , 0) ; font-size: 12px&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;fillColor=none;align=right;verticalAlign=bottom;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=0;fontSize=11;labelPosition=left;verticalLabelPosition=top;fontColor=#FF0000;strokeColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="339" y="307" width="230" height="53" as="geometry" />
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-64" value="SM4" style="edgeLabel;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;labelBackgroundColor=none;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="871" y="423" as="geometry">
            <mxPoint x="-8" y="-70" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ex2G36TkrBTLP0KI2J1V-68" value="ADK(管理密钥对)&lt;br&gt;&lt;span style=&quot;color: rgb(241 , 156 , 153)&quot;&gt;SM2算法密钥对&lt;br&gt;用于加密用户PIN码&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=right;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;labelBackgroundColor=none;sketch=0;fontSize=11;fontColor=#000000;labelBorderColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="176" y="260" width="166" height="50" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
